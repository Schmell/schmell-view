import{s as V,e as g,a as q,t as C,c as I,b as v,g as F,d as G,f as h,o as w,D as p,i as U,h as T,j as z,u as D,n as A}from"./scheduler.60fdcb34.js";import{S as H,i as J,g as K,b as L,e as M,t as y,c as N,a as j,m as B,d as O}from"./index.c7b4b125.js";import{i as P}from"./navigation.82bf316a.js";import{b as E}from"./index.b20a7130.js";import{I as S}from"./Icon.8be3835b.js";import{e as Q,f as R}from"./index.f836e1a8.js";function W(r){let e,i,a,n,c,l;return i=new S({props:{icon:"mdi:thumb-up-outline"}}),{c(){e=g("button"),N(i.$$.fragment),this.h()},l(t){e=I(t,"BUTTON",{});var f=v(e);j(i.$$.fragment,f),f.forEach(h),this.h()},h(){var t;e.disabled=a=r[1]===((t=r[2].User)==null?void 0:t.id)||r[1]===r[2].publisherId},m(t,f){U(t,e,f),B(i,e,null),n=!0,c||(l=D(e,"click",r[9]),c=!0)},p(t,f){var _;(!n||f&6&&a!==(a=t[1]===((_=t[2].User)==null?void 0:_.id)||t[1]===t[2].publisherId))&&(e.disabled=a)},i(t){n||(y(i.$$.fragment,t),n=!0)},o(t){L(i.$$.fragment,t),n=!1},d(t){t&&h(e),O(i),c=!1,l()}}}function X(r){let e,i,a,n,c;return i=new S({props:{class:"text-base-100",icon:"mdi:thumb-up"}}),{c(){e=g("button"),N(i.$$.fragment)},l(l){e=I(l,"BUTTON",{});var t=v(e);j(i.$$.fragment,t),t.forEach(h)},m(l,t){U(l,e,t),B(i,e,null),a=!0,n||(c=D(e,"click",r[8]),n=!0)},p:A,i(l){a||(y(i.$$.fragment,l),a=!0)},o(l){L(i.$$.fragment,l),a=!1},d(l){l&&h(e),O(i),n=!1,c()}}}function Y(r){let e,i,a,n,c,l,t=(r[2]._count?r[2]._count.Likes:0)+"",f,_,d;const k=[X,W],m=[];function u(s,o){return o&4&&(i=null),i==null&&(i=!!s[5](s[2])),i?0:1}return a=u(r,-1),n=m[a]=k[a](r),{c(){e=g("div"),n.c(),c=q(),l=g("div"),f=C(t),this.h()},l(s){e=I(s,"DIV",{class:!0});var o=v(e);n.l(o),c=F(o),l=I(o,"DIV",{class:!0});var b=v(l);f=G(b,t),b.forEach(h),o.forEach(h),this.h()},h(){w(l,"class","border-l-2 border-base-200 pl-2 cursor-default"),p(l,"text-base-100",r[5](r[2])),w(e,"class",_=E("flex items-center gap-2 px-2 rounded-full",r[0])),p(e,"bg-accent",r[5](r[2])),p(e,"bg-base-100",!r[5](r[2]))},m(s,o){U(s,e,o),m[a].m(e,null),T(e,c),T(e,l),T(l,f),d=!0},p(s,[o]){let b=a;a=u(s,o),a===b?m[a].p(s,o):(K(),L(m[b],1,1,()=>{m[b]=null}),M(),n=m[a],n?n.p(s,o):(n=m[a]=k[a](s),n.c()),y(n,1),n.m(e,c)),(!d||o&4)&&t!==(t=(s[2]._count?s[2]._count.Likes:0)+"")&&z(f,t),(!d||o&36)&&p(l,"text-base-100",s[5](s[2])),(!d||o&1&&_!==(_=E("flex items-center gap-2 px-2 rounded-full",s[0])))&&w(e,"class",_),(!d||o&37)&&p(e,"bg-accent",s[5](s[2])),(!d||o&37)&&p(e,"bg-base-100",!s[5](s[2]))},i(s){d||(y(n),d=!0)},o(s){L(n),d=!1},d(s){s&&h(e),m[a].d()}}}function Z(r,e,i){let{class:a=void 0}=e,{userId:n}=e;if(!n)throw Q(400,"Invalid userId in like component");let{item:c}=e,{type:l}=e,t;function f(u){return u.Likes.find(o=>{if(o.userId===n)return o}).id}function _(u){return u.Likes?!!u.Likes.some(s=>s.userId===n):!1}async function d(u,s,o=!1){try{i(7,t=await fetch(`/api/like?likeType=${u}&itemId=${s.id}${o?`&unlike=${f(s)}`:""}`,{method:"GET",headers:{"content-type":"application/json"}}))}catch(b){throw console.log("error: ",b),R(400,{message:"add like error"})}}const k=()=>{d(l,c,f(c))},m=()=>{d(l,c,!1)};return r.$$set=u=>{"class"in u&&i(0,a=u.class),"userId"in u&&i(1,n=u.userId),"item"in u&&i(2,c=u.item),"type"in u&&i(3,l=u.type)},r.$$.update=()=>{r.$$.dirty&128&&t!=null&&t.ok&&P()},[a,n,c,l,f,_,d,t,k,m]}class ie extends H{constructor(e){super(),J(this,e,Z,Y,V,{class:0,userId:1,item:2,type:3})}}export{ie as L};
