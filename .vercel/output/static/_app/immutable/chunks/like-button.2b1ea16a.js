import{s as C,l as F,i as w,f as m,e as y,c as T,b as U,u as L,o as J,n as S}from"./scheduler.60fdcb34.js";import{S as P,i as z,g as j,b as k,e as G,t as h,c as E,a as N,m as v,d as B}from"./index.c7b4b125.js";import{i as A}from"./navigation.82bf316a.js";import{b as g}from"./index.b20a7130.js";import{I as O}from"./Icon.8be3835b.js";import{e as D,f as H}from"./index.f836e1a8.js";function K(c){let n,e,l,r,a,u;return e=new O({props:{class:g("text-base-content",c[0]),icon:"mdi:bell-badge-outline"}}),{c(){n=y("button"),E(e.$$.fragment),this.h()},l(t){n=T(t,"BUTTON",{});var i=U(n);N(e.$$.fragment,i),i.forEach(m),this.h()},h(){var t;n.disabled=l=c[3]===((t=c[2].User)==null?void 0:t.id)||c[3]===c[2].publisherId},m(t,i){w(t,n,i),v(e,n,null),r=!0,a||(u=L(n,"click",c[9]),a=!0)},p(t,i){var s;const o={};i&1&&(o.class=g("text-base-content",t[0])),e.$set(o),(!r||i&12&&l!==(l=t[3]===((s=t[2].User)==null?void 0:s.id)||t[3]===t[2].publisherId))&&(n.disabled=l)},i(t){r||(h(e.$$.fragment,t),r=!0)},o(t){k(e.$$.fragment,t),r=!1},d(t){t&&m(n),B(e),a=!1,u()}}}function M(c){let n,e,l,r,a;return e=new O({props:{class:g("text-base-content",c[0]),icon:"mdi:bell-ring"}}),{c(){n=y("button"),E(e.$$.fragment)},l(u){n=T(u,"BUTTON",{});var t=U(n);N(e.$$.fragment,t),t.forEach(m)},m(u,t){w(u,n,t),v(e,n,null),l=!0,r||(a=L(n,"click",c[8]),r=!0)},p(u,t){const i={};t&1&&(i.class=g("text-base-content",u[0])),e.$set(i)},i(u){l||(h(e.$$.fragment,u),l=!0)},o(u){k(e.$$.fragment,u),l=!1},d(u){u&&m(n),B(e),r=!1,a()}}}function Q(c){let n,e,l,r,a;const u=[M,K],t=[];function i(o,s){return s&4&&(n=null),n==null&&(n=!!o[5](o[2])),n?0:1}return e=i(c,-1),l=t[e]=u[e](c),{c(){l.c(),r=F()},l(o){l.l(o),r=F()},m(o,s){t[e].m(o,s),w(o,r,s),a=!0},p(o,[s]){let f=e;e=i(o,s),e===f?t[e].p(o,s):(j(),k(t[f],1,1,()=>{t[f]=null}),G(),l=t[e],l?l.p(o,s):(l=t[e]=u[e](o),l.c()),h(l,1),l.m(r.parentNode,r))},i(o){a||(h(l),a=!0)},o(o){k(l),a=!1},d(o){o&&m(r),t[e].d(o)}}}function R(c,n,e){let{class:l=void 0}=n,{type:r}=n,{item:a}=n,{userId:u}=n;if(!u)throw D(400,"Invalid userId in like component");let t;function i(_){return console.log("item: ",_),_.Follows.find(b=>{const p=b.userId===u;if(b)return p}).id}function o(_){return _.Follows?!!_.Follows.some(d=>d.userId===u):!1}async function s(_,d,b=!1){try{e(7,t=await fetch(`/api/follow?followType=${_}&itemId=${d.id}${b?`&unfollow=${i(d)}`:""}`,{method:"GET",headers:{"content-type":"application/json"}}))}catch(p){throw console.log("error: ",p),H(400,{message:"add follow error"})}}const f=()=>{s(r,a,i(a))},I=()=>{s(r,a,!1)};return c.$$set=_=>{"class"in _&&e(0,l=_.class),"type"in _&&e(1,r=_.type),"item"in _&&e(2,a=_.item),"userId"in _&&e(3,u=_.userId)},c.$$.update=()=>{c.$$.dirty&128&&t!=null&&t.ok&&A()},[l,r,a,u,i,o,s,t,f,I]}class re extends P{constructor(n){super(),z(this,n,R,Q,C,{class:0,type:1,item:2,userId:3})}}function V(c){let n,e,l,r,a,u;return e=new O({props:{class:g("text-base-100",c[0]),icon:"mdi:thumb-up-outline"}}),{c(){n=y("button"),E(e.$$.fragment),this.h()},l(t){n=T(t,"BUTTON",{});var i=U(n);N(e.$$.fragment,i),i.forEach(m),this.h()},h(){var t;n.disabled=l=c[1]===((t=c[2].User)==null?void 0:t.id)||c[1]===c[2].publisherId},m(t,i){w(t,n,i),v(e,n,null),r=!0,a||(u=L(n,"click",c[10]),a=!0)},p(t,i){var s;const o={};i&1&&(o.class=g("text-base-100",t[0])),e.$set(o),(!r||i&6&&l!==(l=t[1]===((s=t[2].User)==null?void 0:s.id)||t[1]===t[2].publisherId))&&(n.disabled=l)},i(t){r||(h(e.$$.fragment,t),r=!0)},o(t){k(e.$$.fragment,t),r=!1},d(t){t&&m(n),B(e),a=!1,u()}}}function W(c){let n,e,l,r,a,u;const t=[Y,X],i=[];function o(s,f){return s[4]?0:1}return e=o(c),l=i[e]=t[e](c),{c(){n=y("button"),l.c()},l(s){n=T(s,"BUTTON",{});var f=U(n);l.l(f),f.forEach(m)},m(s,f){w(s,n,f),i[e].m(n,null),r=!0,a||(u=L(n,"click",c[9]),a=!0)},p(s,f){let I=e;e=o(s),e===I?i[e].p(s,f):(j(),k(i[I],1,1,()=>{i[I]=null}),G(),l=i[e],l?l.p(s,f):(l=i[e]=t[e](s),l.c()),h(l,1),l.m(n,null))},i(s){r||(h(l),r=!0)},o(s){k(l),r=!1},d(s){s&&m(n),i[e].d(),a=!1,u()}}}function X(c){let n,e;return n=new O({props:{class:g("text-base-100",c[0]),icon:"mdi:thumb-up"}}),{c(){E(n.$$.fragment)},l(l){N(n.$$.fragment,l)},m(l,r){v(n,l,r),e=!0},p(l,r){const a={};r&1&&(a.class=g("text-base-100",l[0])),n.$set(a)},i(l){e||(h(n.$$.fragment,l),e=!0)},o(l){k(n.$$.fragment,l),e=!1},d(l){B(n,l)}}}function Y(c){let n;return{c(){n=y("span"),this.h()},l(e){n=T(e,"SPAN",{class:!0}),U(n).forEach(m),this.h()},h(){J(n,"class","loading loading-spinner loading-sm")},m(e,l){w(e,n,l)},p:S,i:S,o:S,d(e){e&&m(n)}}}function Z(c){let n,e,l,r,a;const u=[W,V],t=[];function i(o,s){return s&4&&(n=null),n==null&&(n=!!o[6](o[2])),n?0:1}return e=i(c,-1),l=t[e]=u[e](c),{c(){l.c(),r=F()},l(o){l.l(o),r=F()},m(o,s){t[e].m(o,s),w(o,r,s),a=!0},p(o,[s]){let f=e;e=i(o,s),e===f?t[e].p(o,s):(j(),k(t[f],1,1,()=>{t[f]=null}),G(),l=t[e],l?l.p(o,s):(l=t[e]=u[e](o),l.c()),h(l,1),l.m(r.parentNode,r))},i(o){a||(h(l),a=!0)},o(o){k(l),a=!1},d(o){o&&m(r),t[e].d(o)}}}function $(c,n,e){let{class:l=void 0}=n,{userId:r}=n;if(!r)throw D(400,"Invalid userId in like component");let{item:a}=n,{type:u}=n,t,i=!1;function o(d){return d.Likes.find(p=>{if(p.userId===r)return p}).id}function s(d){return d.Likes?!!d.Likes.some(b=>b.userId===r):!1}async function f(d,b,p=!1){try{e(4,i=!0),e(8,t=await fetch(`/api/like?likeType=${d}&itemId=${b.id}${p?`&unlike=${o(b)}`:""}`,{method:"GET",headers:{"content-type":"application/json"}})),e(4,i=!1)}catch(q){throw console.log("error: ",q),H(400,{message:"add like error"})}}const I=()=>{f(u,a,o(a))},_=()=>{f(u,a,!1)};return c.$$set=d=>{"class"in d&&e(0,l=d.class),"userId"in d&&e(1,r=d.userId),"item"in d&&e(2,a=d.item),"type"in d&&e(3,u=d.type)},c.$$.update=()=>{c.$$.dirty&256&&t!=null&&t.ok&&A()},[l,r,a,u,i,o,s,f,t,I,_]}class se extends P{constructor(n){super(),z(this,n,$,Z,C,{class:0,userId:1,item:2,type:3})}}export{re as F,se as L};
